<!doctype html>
<html lang="fr" class="h-full">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Wild Drafter</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap"
      rel="stylesheet"
    >
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

    <style>
      @view-transition { navigation: auto; }
      :root { view-transition-name: none; }
      main.container { contain: view-transition; view-transition-name: page; }
      html::view-transition-old(page),
      html::view-transition-new(page) {
        animation-duration: .32s;
        animation-timing-function: cubic-bezier(.2, .6, .2, 1);
      }
      @keyframes fade-slide-out {
        from { opacity: 1; transform: translateY(0) scale(1); }
        to { opacity: 0; transform: translateY(6px) scale(.98); }
      }
      @keyframes fade-slide-in {
        from { opacity: 0; transform: translateY(6px) scale(.98); }
        to { opacity: 1; transform: translateY(0) scale(1); }
      }
      html::view-transition-old(page) { animation-name: fade-slide-out; }
      html::view-transition-new(page) { animation-name: fade-slide-in; }
      @media (prefers-reduced-motion: reduce) {
        html::view-transition-old(page),
        html::view-transition-new(page) {
          animation: none !important;
        }
      }
    </style>
  </head>
  <body class="dark">
    <header class="header">
      <div class="container header-flex">
        <div class="brand clickable" id="brand-restart">
          <img
            class="brand-logo"
            src="{{ url_for('static', filename='icons/jungle.png') }}"
            alt="Logo Jungle"
          >
          <div>
            <div class="brand-title">Wild Drafter</div>
            <div class="brand-sub">Assistant de draft jungle</div>
          </div>
        </div>

        <div class="header-right">
          <button id="toggle-live" class="btn-live disabled" title="Live Preview">
            <span class="live-dot"></span>
            Live Preview
          </button>

          <button
            class="icon-circle"
            type="button"
            title="Administration"
            aria-label="Ouvrir l‚Äôadministration"
            onclick="window.location.href='/admin'"
          >
            <span class="admin-emoji" aria-hidden="true">‚öôÔ∏è</span>
          </button>

          <a
            href="{{ url_for('changelog') }}"
            class="icon-circle changelog-btn"
            title="Changelog"
            aria-label="Ouvrir le changelog"
          >
            <svg class="changelog-svg" viewBox="0 0 24 24" aria-hidden="true">
              <circle cx="6" cy="7" r="1.6"></circle>
              <circle cx="6" cy="12" r="1.6"></circle>
              <circle cx="6" cy="17" r="1.6"></circle>
              <rect x="10" y="6"  width="8" height="2" rx="1"></rect>
              <rect x="10" y="11" width="8" height="2" rx="1"></rect>
              <rect x="10" y="16" width="8" height="2" rx="1"></rect>
            </svg>
          </a>
        </div>
      </div>
    </header>

    <main class="container">
      {% block content %}{% endblock %}
    </main>

    <footer class="footer">
      <div class="container">
        <span>üõ†Ô∏è Wild x ChatGPT - {{ current_year }}</span>
      </div>
    </footer>

    {% block scripts %}{% endblock %}

    <div id="transition-wrapper" class="transition-wrapper"></div>

    <script>
      window.WILD_DRAFTER = Object.assign(window.WILD_DRAFTER || {}, {
        STORAGE_KEY: "wild_drafter.customChampions"
      });

      document.addEventListener("DOMContentLoaded", () => {
        const restart = document.getElementById("brand-restart");
        restart?.addEventListener("click", () => {
          if (window.location.pathname === "/") {
            window.dispatchEvent(new CustomEvent("wilddrafter:restart"));
            return;
          }
          window.location.href = "/";
        });

        const liveBtn = document.getElementById("toggle-live");
        if (!liveBtn) return;

        const isQuestionPage = window.location.pathname === "/";
        if (isQuestionPage) {
          liveBtn.classList.remove("disabled");
          liveBtn.addEventListener("click", () => {
            document.getElementById("live-preview")?.classList.toggle("visible");
          });
        } else {
          liveBtn.classList.add("disabled");
        }
      });
    </script>
  </body>
</html>
